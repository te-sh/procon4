---
layout: ../../../../../layouts/Content.astro
title: "ABC342 D"
problem: https://atcoder.jp/contests/abc342/tasks/abc342_d
---
まずは $A_i = 0$ である要素は取り除き, ぞの数 $n_z$ を数えておく.

$A_i$ をすべて素因数分解し, 奇数の指数を持つ素因数のみを抽出した配列 $F_i$ にする.

このとき, $A_iA_j$ が平方数になるためには, $F_i$ と $F_j$ が一致しなければならない.

よって, $F_i$ の種類ごとに数を数える. ある種類の数が $n$ とすると, 同じ種類のもの同士の組み合わせの数は $\comb{n}{2}$ で計算できる. これをすべての種類について足し合わせる.

最後に $A_i = 0$ となっていた要素の扱いだが, $0$ は何を掛けても平方数になるので, すべての要素と対応可能である.

この組み合わせの数は,

$$
\sum_{k = N-n_z}^{N-1} k = \frac{(N-1)N}{2} - \frac{(N-n_z-1)(N-n_z)}{2}
$$

で計算できる.
